## 调试目标
- 无需开关，默认启用详细启动调试，精确定位客户端初始化失败的具体步骤并输出可读、结构化日志。
- 不泄露敏感信息（尤其是 `DISCORD_TOKEN`）。

## 调试内容（始终启用）
- 步骤追踪：配置读取→Token预检→命令加载→登录→事件绑定→网关与网络探针→故障摘要。
- 详细日志级别：默认 `LOG_LEVEL=debug`（在生产可回退为 `info`，但本方案不再依赖开关）。

## 新增/增强模块
- `src/utils/debug.js`：
  - `trace(step, details)` 输出结构化调试日志（不含敏感信息）。
  - `error(step, err)` 统一错误记录（name/code/message/stack）。
  - `summary()` 汇总步骤与最后错误，供启动失败时输出。

- `src/utils/token_precheck.js`（增强）：
  - 测试 `/users/@me` 与 `/gateway`，记录 `reason`、`httpStatus` 或网络错误码。
  - 记录代理环境状态（`HTTP_PROXY/HTTPS_PROXY`，仅 `present: true/false`）。

## 集成位置
- `src/index.js`：
  - 在 `start()` 中按步骤 `trace`：`config.valid`、`token.precheck`、`client.init`、`commands.load`、`login.attempt`、`login.success` 或 `login.failed`、`events.bound`、`gateway.probe`。
  - 在捕获启动失败时，调用 `debug.summary()` 输出总览日志。

- `src/bot/client.js`：
  - 命令加载：逐个 `require` 包裹 `try/catch`，记录失败命令名与错误。
  - 登录：记录 `error.name`、`error.code`、`message`、`stack`。
  - 事件绑定（标准事件名）：`ready`、`debug`、`rateLimit`、`invalidated`、`shardError`、`shardDisconnect`、`shardReconnecting`、`shardReady`，均输出关键上下文（不含敏感信息）。

## 网络与代理探针
- `dns.lookup('discord.com')` 耗时与结果。
- `/gateway` 接口可达性（状态码）。

## 安全保证
- 严禁打印 `DISCORD_TOKEN`；仅记录 `tokenPresent: true/false` 与 `clientId`。
- 日志保留 `[timestamp][LEVEL][message][context]` 格式，便于自动化分析。

## 验证
- 直接运行 `npm start`：观察调试日志是否按步骤输出；失败时具备故障摘要。
- 在生产环境如需降低日志冗余，可调整 `LOG_LEVEL=info`，调试仍保留但减少非关键 `debug` 级别输出（本方案默认保持详细）。

## 交付
- 修改上述文件，保证详细调试默认开启；不添加开关条件。