# ğŸš€ Bilibili Discord Bot - éƒ¨ç½²æŒ‡å—

## ğŸ“‹ éƒ¨ç½²å‰å‡†å¤‡

### ç³»ç»Ÿè¦æ±‚

- Node.js 18.x+
- Python 3.8+ (ç”¨äº yt-dlp)
- FFmpeg (æ¨èå®‰è£…)

### æ£€æŸ¥ç¯å¢ƒ

```bash
node --version     # åº”è¯¥æ˜¾ç¤º v18.x æˆ–æ›´é«˜
python3 --version  # åº”è¯¥æ˜¾ç¤º 3.8 æˆ–æ›´é«˜
ffmpeg -version    # æ£€æŸ¥FFmpeg (å¯é€‰ä½†æ¨è)
```

## ğŸ”§ ç¬¬ä¸€æ­¥ï¼šåˆ›å»º Discord åº”ç”¨ç¨‹åº

### 1. è®¿é—® Discord å¼€å‘è€…é—¨æˆ·

è®¿é—®ï¼šhttps://discord.com/developers/applications

### 2. åˆ›å»ºæ–°åº”ç”¨ç¨‹åº

1. ç‚¹å‡» **"New Application"**
2. è¾“å…¥åº”ç”¨ç¨‹åºåç§°ï¼š`Bilibili Music Bot`
3. ç‚¹å‡» **"Create"**

### 3. åˆ›å»ºæœºå™¨äºº

1. åœ¨å·¦ä¾§èœå•ä¸­ç‚¹å‡» **"Bot"**
2. ç‚¹å‡» **"Add Bot"**
3. ç¡®è®¤åˆ›å»ºæœºå™¨äºº

### 4. é…ç½®æœºå™¨äººè®¾ç½®

åœ¨ Bot é¡µé¢ä¸­ï¼š

- âœ… **Public Bot**: å¼€å¯ (å…è®¸å…¶ä»–äººé‚€è¯·)
- âŒ **Requires OAuth2 Code Grant**: å…³é—­
- âœ… **Presence Intent**: å¼€å¯
- âœ… **Server Members Intent**: å¼€å¯
- âœ… **Message Content Intent**: å¼€å¯

### 5. è·å– Bot Token

1. åœ¨ Bot é¡µé¢ä¸­ï¼Œæ‰¾åˆ° **"Token"** éƒ¨åˆ†
2. ç‚¹å‡» **"Reset Token"**
3. å¤åˆ¶æ˜¾ç¤ºçš„ Tokenï¼ˆâš ï¸ è¿™ä¸ª Token åªæ˜¾ç¤ºä¸€æ¬¡ï¼Œè¯·å¦¥å–„ä¿å­˜ï¼‰

## ğŸ”‘ ç¬¬äºŒæ­¥ï¼šé…ç½®æœºå™¨äººæƒé™

### 1. è®¾ç½® OAuth2 æƒé™

1. åœ¨å·¦ä¾§èœå•ä¸­ç‚¹å‡» **"OAuth2"** â†’ **"URL Generator"**
2. åœ¨ **"Scopes"** ä¸­é€‰æ‹©ï¼š
   - âœ… `bot`
   - âœ… `applications.commands`

### 2. è®¾ç½® Bot æƒé™

åœ¨ **"Bot Permissions"** ä¸­é€‰æ‹©ï¼š

- âœ… **Send Messages** (å‘é€æ¶ˆæ¯)
- âœ… **Use Slash Commands** (ä½¿ç”¨æ–œæ å‘½ä»¤)
- âœ… **Connect** (è¿æ¥è¯­éŸ³é¢‘é“)
- âœ… **Speak** (åœ¨è¯­éŸ³é¢‘é“ä¸­è¯´è¯)
- âœ… **Use Voice Activity** (ä½¿ç”¨è¯­éŸ³æ´»åŠ¨)
- âœ… **Embed Links** (åµŒå…¥é“¾æ¥)
- âœ… **Attach Files** (é™„åŠ æ–‡ä»¶)
- âœ… **Read Message History** (è¯»å–æ¶ˆæ¯å†å²)

### 3. è·å–é‚€è¯·é“¾æ¥

å¤åˆ¶ç”Ÿæˆçš„ URLï¼Œè¿™å°±æ˜¯æ‚¨çš„æœºå™¨äººé‚€è¯·é“¾æ¥ã€‚

## âš™ï¸ ç¬¬ä¸‰æ­¥ï¼šé…ç½®æœºå™¨äººç¯å¢ƒ

### 1. å®‰è£…ä¾èµ–

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd "/Users/bryan/Desktop/Projects/Mine/Bilibili Player"

# å®‰è£…Node.jsä¾èµ–
npm install

# å®‰è£…yt-dlp
pip3 install yt-dlp

# å®‰è£…FFmpeg (æ¨è)
# macOS:
brew install ffmpeg

# Ubuntu:
# sudo apt update && sudo apt install ffmpeg

# Windows:
# ä» https://ffmpeg.org/download.html ä¸‹è½½
```

### 2. åˆ›å»ºç¯å¢ƒé…ç½®æ–‡ä»¶

```bash
# å¤åˆ¶ç¯å¢ƒé…ç½®æ¨¡æ¿
cp .env.example .env
```

### 3. ç¼–è¾‘ .env æ–‡ä»¶

ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€ `.env` æ–‡ä»¶ï¼Œå¡«å…¥ä»¥ä¸‹ä¿¡æ¯ï¼š

```env
# Discordæœºå™¨äººé…ç½®
DISCORD_TOKEN=your_bot_token_here
CLIENT_ID=your_application_id_here
GUILD_ID=your_test_server_id_here

# ç³»ç»Ÿé…ç½®
NODE_ENV=production
LOG_LEVEL=info
```

#### å¦‚ä½•è·å–å„ä¸ª IDï¼š

**CLIENT_ID (åº”ç”¨ç¨‹åº ID)ï¼š**

1. åœ¨ Discord å¼€å‘è€…é—¨æˆ·ä¸­
2. ç‚¹å‡»æ‚¨çš„åº”ç”¨ç¨‹åº
3. åœ¨ **"General Information"** é¡µé¢å¤åˆ¶ **"Application ID"**

**GUILD_ID (æœåŠ¡å™¨ ID) - å¯é€‰ï¼š**

1. åœ¨ Discord ä¸­å¼€å¯å¼€å‘è€…æ¨¡å¼ï¼šç”¨æˆ·è®¾ç½® â†’ é«˜çº§ â†’ å¼€å‘è€…æ¨¡å¼
2. å³é”®ç‚¹å‡»æ‚¨çš„æœåŠ¡å™¨å›¾æ ‡
3. é€‰æ‹© **"å¤åˆ¶æœåŠ¡å™¨ ID"**

## ğŸš€ ç¬¬å››æ­¥ï¼šéƒ¨ç½²æœºå™¨äºº

### 1. éƒ¨ç½²æ–œæ å‘½ä»¤

```bash
# éƒ¨ç½²å‘½ä»¤åˆ°Discord
npm run deploy:commands
```

æ‚¨åº”è¯¥çœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„è¾“å‡ºï¼š

```
Successfully deployed guild commands
Deployed command: play
Deployed command: pause
Deployed command: resume
Deployed command: skip
Deployed command: prev
Deployed command: queue
Deployed command: nowplaying
```

### 2. æµ‹è¯•ç³»ç»Ÿ

```bash
# è¿è¡Œç³»ç»Ÿæµ‹è¯•
npm run test:system
```

ç¡®ä¿çœ‹åˆ°ï¼š`ğŸŸ¢ EXCELLENT - System is production ready!`

### 3. å¯åŠ¨æœºå™¨äºº

```bash
# å¯åŠ¨æœºå™¨äºº
npm start
```

æ‚¨åº”è¯¥çœ‹åˆ°ï¼š

```
Discord bot is ready!
Bot statistics: { ready: true, guilds: 0, users: 0 }
```

## ğŸ® ç¬¬äº”æ­¥ï¼šé‚€è¯·æœºå™¨äººåˆ°æ‚¨çš„æœåŠ¡å™¨

### 1. ä½¿ç”¨é‚€è¯·é“¾æ¥

1. æ‰“å¼€ä¹‹å‰å¤åˆ¶çš„ OAuth2 é‚€è¯·é“¾æ¥
2. é€‰æ‹©æ‚¨è¦æ·»åŠ æœºå™¨äººçš„æœåŠ¡å™¨
3. ç¡®è®¤æƒé™å¹¶ç‚¹å‡» **"æˆæƒ"**

### 2. éªŒè¯æœºå™¨äººåœ¨çº¿

åœ¨æ‚¨çš„ Discord æœåŠ¡å™¨ä¸­ï¼Œæ‚¨åº”è¯¥çœ‹åˆ°æœºå™¨äººå·²ä¸Šçº¿ï¼ˆç»¿è‰²çŠ¶æ€ï¼‰ã€‚

## ğŸµ ç¬¬å…­æ­¥ï¼šæµ‹è¯•æœºå™¨äººåŠŸèƒ½

### 1. æµ‹è¯•åŸºç¡€å‘½ä»¤

åœ¨ä»»æ„é¢‘é“ä¸­è¾“å…¥ï¼š

```
/play url:https://www.bilibili.com/video/BV1uv4y1q7Mv
```

### 2. æµ‹è¯•æ’­æ”¾æ§åˆ¶

æœºå™¨äººåº”è¯¥ä¼šï¼š

1. æ˜¾ç¤ºæ­£åœ¨åŠ è½½çš„æ¶ˆæ¯
2. æå–è§†é¢‘ä¿¡æ¯
3. æ˜¾ç¤ºç²¾ç¾çš„æ’­æ”¾ç•Œé¢
4. æä¾›äº¤äº’å¼æ§åˆ¶æŒ‰é’®

### 3. æµ‹è¯•å…¶ä»–å‘½ä»¤

```
/queue          # æŸ¥çœ‹æ’­æ”¾é˜Ÿåˆ—
/pause          # æš‚åœæ’­æ”¾
/resume         # æ¢å¤æ’­æ”¾
/skip           # è·³åˆ°ä¸‹ä¸€é¦–
/nowplaying     # æ˜¾ç¤ºå½“å‰æ’­æ”¾ä¿¡æ¯
```

## ğŸ› ï¸ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**â“ æœºå™¨äººæ— æ³•è¿æ¥åˆ°è¯­éŸ³é¢‘é“**

- ç¡®ä¿æœºå™¨äººæœ‰ **"Connect"** å’Œ **"Speak"** æƒé™
- ç¡®ä¿æ‚¨åœ¨è¯­éŸ³é¢‘é“ä¸­

**â“ æ–œæ å‘½ä»¤ä¸æ˜¾ç¤º**

- ç­‰å¾… 1-5 åˆ†é’Ÿè®© Discord åŒæ­¥å‘½ä»¤
- æ£€æŸ¥æœºå™¨äººæ˜¯å¦æœ‰ **"Use Slash Commands"** æƒé™
- é‡æ–°è¿è¡Œ `npm run deploy:commands`

**â“ éŸ³é¢‘æ’­æ”¾å¤±è´¥**

- æ£€æŸ¥æ˜¯å¦å®‰è£…äº† FFmpeg: `ffmpeg -version`
- æ£€æŸ¥æ˜¯å¦å®‰è£…äº† yt-dlp: `yt-dlp --version`
- æŸ¥çœ‹æ§åˆ¶å°é”™è¯¯æ—¥å¿—

**â“ æå–è§†é¢‘å¤±è´¥**

- ç¡®ä¿ URL æ˜¯æœ‰æ•ˆçš„ Bilibili é“¾æ¥
- æ£€æŸ¥è§†é¢‘æ˜¯å¦ä¸ºç§äººæˆ–åœ°åŒºé™åˆ¶
- å°è¯•å…¶ä»– Bilibili è§†é¢‘

### æ—¥å¿—æŸ¥çœ‹

æœºå™¨äººè¿è¡Œæ—¶ä¼šæ˜¾ç¤ºè¯¦ç»†æ—¥å¿—ï¼š

```bash
# æŸ¥çœ‹å®æ—¶æ—¥å¿—
npm start

# æˆ–è€…ä½¿ç”¨å¼€å‘æ¨¡å¼
npm run dev
```

### é‡å¯æœºå™¨äºº

```bash
# åœæ­¢æœºå™¨äººï¼šCtrl+C
# é‡æ–°å¯åŠ¨ï¼š
npm start
```

## ğŸ”„ ä¿æŒæœºå™¨äººè¿è¡Œ

### ä½¿ç”¨ PM2 (æ¨è)

```bash
# å®‰è£…PM2
npm install -g pm2

# å¯åŠ¨æœºå™¨äºº
pm2 start src/index.js --name "bilibili-bot"

# æŸ¥çœ‹çŠ¶æ€
pm2 status

# æŸ¥çœ‹æ—¥å¿—
pm2 logs bilibili-bot

# åœæ­¢æœºå™¨äºº
pm2 stop bilibili-bot
```

### ä½¿ç”¨ Screen (Linux/macOS)

```bash
# åˆ›å»ºæ–°ä¼šè¯
screen -S bilibili-bot

# å¯åŠ¨æœºå™¨äºº
npm start

# åˆ†ç¦»ä¼šè¯ï¼šCtrl+A, ç„¶åæŒ‰D
# é‡æ–°è¿æ¥ï¼šscreen -r bilibili-bot
```

## ğŸ¯ ä½¿ç”¨æŠ€å·§

### æ”¯æŒçš„ URL æ ¼å¼

- `https://www.bilibili.com/video/BV*`
- `https://www.bilibili.com/video/av*`
- `https://b23.tv/*` (çŸ­é“¾æ¥)
- `https://m.bilibili.com/video/*` (ç§»åŠ¨ç«¯)

### æŒ‰é’®æ§åˆ¶

- â®ï¸ **ä¸Šä¸€é¦–** - è¿”å›ä¸Šä¸€ä¸ªè§†é¢‘
- â¸ï¸ **æš‚åœ/æ’­æ”¾** - åˆ‡æ¢æ’­æ”¾çŠ¶æ€
- â­ï¸ **ä¸‹ä¸€é¦–** - è·³åˆ°ä¸‹ä¸€ä¸ªè§†é¢‘
- ğŸ“‹ **é˜Ÿåˆ—** - æ˜¾ç¤ºæ’­æ”¾é˜Ÿåˆ—
- ğŸ”€ **æ´—ç‰Œ** - éšæœºæ‰“ä¹±é˜Ÿåˆ—
- ğŸ” **å¾ªç¯** - åˆ‡æ¢å¾ªç¯æ¨¡å¼
- ğŸ—‘ï¸ **æ¸…ç©º** - æ¸…ç©ºæ’­æ”¾é˜Ÿåˆ—

### æœ€ä½³å®è·µ

1. **ä¸€æ¬¡æ·»åŠ å¤šä¸ªè§†é¢‘** - ä½¿ç”¨å¤šä¸ª `/play` å‘½ä»¤å»ºç«‹æ’­æ”¾é˜Ÿåˆ—
2. **ä½¿ç”¨äº¤äº’å¼æŒ‰é’®** - æ¯”æ–œæ å‘½ä»¤æ›´å¿«æ·
3. **ç®¡ç†é˜Ÿåˆ—** - å®šæœŸæ¸…ç†é•¿é˜Ÿåˆ—é¿å…æ··ä¹±
4. **æƒé™ç®¡ç†** - åªç»™ä¿¡ä»»çš„ç”¨æˆ·éŸ³ä¹æ§åˆ¶æƒé™

## ğŸ†˜ è·å–å¸®åŠ©

å¦‚æœé‡åˆ°é—®é¢˜ï¼š

1. æŸ¥çœ‹æ§åˆ¶å°é”™è¯¯æ—¥å¿—
2. è¿è¡Œ `npm run test:system` æ£€æŸ¥ç³»ç»ŸçŠ¶æ€
3. ç¡®è®¤æ‰€æœ‰ä¾èµ–éƒ½å·²æ­£ç¡®å®‰è£…
4. æ£€æŸ¥ Discord æœºå™¨äººæƒé™è®¾ç½®

## ğŸ‰ æ­å–œï¼

æ‚¨çš„ Bilibili Discord éŸ³ä¹æœºå™¨äººç°åœ¨å·²ç»æˆåŠŸéƒ¨ç½²å¹¶è¿è¡Œï¼

äº«å—åœ¨ Discord ä¸­æ’­æ”¾ Bilibili è§†é¢‘éŸ³é¢‘çš„ä¹è¶£å§ï¼ ğŸµğŸ®
